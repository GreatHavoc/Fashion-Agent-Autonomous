<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Fashion Agent Pipeline</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <div class="page">
        <div class="page__logos">
            <a class="page__logo" href="#" aria-label="Trent Digital Fashion House">
                <img src="assets/logo1.png" alt="Trent Digital Fashion House" />
            </a>
            <a class="page__logo page__logo--secondary" href="#" aria-label="Trent Digital Fashion House Partner">
                <img src="assets/logo2.png" alt="Trent Digital Fashion House Partner" />
            </a>
        </div>
        <header class="hero">
            <div class="hero__content">
                <h1>Trent Digital Fashion House</h1>
                <p>
                    Design studio in the cloud powered by Agentic AI.
                </p>
                <button id="runPipeline" class="btn btn--primary">Launch Pipeline</button>
                <span id="pipelineStatus" class="hero__status">Idle</span>
            </div>
            <div class="hero__visual">
                <div class="pulse"></div>
                <div class="grid">
                    <div class="grid__item"></div>
                    <div class="grid__item"></div>
                    <div class="grid__item"></div>
                    <div class="grid__item"></div>
                    <div class="grid__item"></div>
                    <div class="grid__item"></div>
                </div>
            </div>
        </header>

        <main class="stageboard" aria-label="Agent Pipeline Dashboard">
            <section class="stageboard__panel stageboard__panel--info">
                <div class="stageboard__progress" id="progressBar"></div>
            </section>
            <section class="stageboard__panel stageboard__panel--visual">
                <div class="stageboard__content" id="stageContent"></div>
            </section>
            <section class="stageboard__panel stageboard__panel--recap">
                <div class="stageboard__header stageboard__header--compact">
                    <h2>Live Output Console</h2>
                    <p>Snapshots of what the pipeline has delivered so far.</p>
                </div>
                <div class="recap" id="liveRecap"></div>
            </section>
        </main>

        <section class="dataflow" aria-label="Detailed Data Flow Insights">
            <div class="dataflow__intro">
                <h2>Agent Data Flow Intelligence</h2>
                <p>A closer look at how LangGraph routes context, artifacts, and retries across the six-agent relay.</p>
            </div>
            <div class="dataflow__grid">
                <article class="dataflow-card">
                    <header class="dataflow-card__header">
                        <span class="dataflow-card__badge">Flow Logic</span>
                        <h3>StateGraph Sequencing</h3>
                    </header>
                    <ul class="dataflow-list">
                        <li><strong>Parallel</strong> &mdash; Data Collector Agent and Video Analyzer Agent fire together; LangGraph waits for both before merging.</li>
                        <li><strong>Gates</strong> &mdash; <code>should_continue_to_content_analyzer</code> and <code>should_continue_to_final_processor</code> guard downstream work.</li>
                        <li><strong>Reducer state</strong> &mdash; <code>FashionAnalysisState</code> uses additive reducers so evidence accumulates instead of overwriting.</li>
                        <li><strong>Status memory</strong> &mdash; <code>execution_status</code> flags completed, failed, or skipped nodes for smart branching.</li>
                    </ul>
                </article>
                <article class="dataflow-card">
                    <header class="dataflow-card__header">
                        <span class="dataflow-card__badge">Artifacts</span>
                        <h3>Persistent Outputs</h3>
                    </header>
                    <ul class="dataflow-list">
                        <li><strong>Source harvest queue</strong> &middot; curated article metadata with provenance.</li>
                        <li><strong>Insight digest</strong> &middot; enriched findings and confidence bands ready for ranking.</li>
                        <li><strong>Runway telemetry</strong> &middot; video trend frequencies and commercial scores.</li>
                        <li><strong>Trend blueprint bundle</strong> &middot; fuels dashboards, merch briefs, and downstream prompts.</li>
                        <li><strong>Creative capsule</strong> &middot; tracks outfit iterations, approvals, and reel assembly queues.</li>
                    </ul>
                </article>
                <article class="dataflow-card">
                    <header class="dataflow-card__header">
                        <span class="dataflow-card__badge">MCP Mesh</span>
                        <h3>Service Surface</h3>
                    </header>
                    <ul class="dataflow-list">
                        <li><strong>8000</strong> &mdash; Scraper MCP catalog (Elle, Vogue, TOI, Instagram hashtags).</li>
                        <li><strong>8100</strong> &mdash; Web capture + DOM extraction powering the Content Analyzer.</li>
                        <li><strong>8001</strong> &mdash; Runway video analyzer producing <code>VideoTrendOutput</code>.</li>
                        <li><strong>8002</strong> &mdash; Outfit generator and verifier loop owned by Reflection.</li>
                        <li><strong>Gemini Veo</strong> &amp; <strong>MoviePy</strong> finalize videos via <code>video_generation.py</code>.</li>
                    </ul>
                </article>
                <article class="dataflow-card">
                    <header class="dataflow-card__header">
                        <span class="dataflow-card__badge">Resilience</span>
                        <h3>Memory &amp; Retry Strategy</h3>
                    </header>
                    <ul class="dataflow-list">
                        <li><strong>MultiAgentMemoryManager</strong> isolates context per agent with <code>thread_id</code> scoping.</li>
                        <li>Exponential backoff (base 22s) parses retry-after hints on Gemini 429s.</li>
                        <li>Structured parsers recover when raw text responses slip past format guards.</li>
                        <li>Pipeline memory enables skip-ahead execution on reruns until the state is cleared.</li>
                    </ul>
                </article>
            </div>
        </section>

        <footer class="footer">
            <p>Multi-agent orchestration for fashion intelligence</p>
        </footer>
    </div>

    <script src="config.js"></script>
    <script src="js/api-client.js"></script>
    <script src="app.js"></script>
</body>
</html>
